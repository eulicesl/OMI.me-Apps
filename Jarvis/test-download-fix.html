<!DOCTYPE html>
<html>
<head>
    <title>Test Download Fix</title>
</head>
<body>
    <h1>Test Download Functions</h1>
    <button onclick="testJSONDownload()">Test JSON Download</button>
    <button onclick="testTextDownload()">Test Text Download</button>
    <div id="status"></div>

    <script>
        function showStatus(msg) {
            document.getElementById('status').innerHTML += `<p>${msg}</p>`;
        }

        function testJSONDownload() {
            try {
                const testData = {
                    test: "data",
                    timestamp: new Date().toISOString(),
                    items: [1, 2, 3]
                };
                
                const dataStr = JSON.stringify(testData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = `test-export-${Date.now()}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.style.display = 'none';
                document.body.appendChild(linkElement);
                linkElement.click();
                document.body.removeChild(linkElement);
                
                showStatus('✅ JSON download triggered successfully');
            } catch (e) {
                showStatus('❌ JSON download failed: ' + e.message);
            }
        }

        function testTextDownload() {
            try {
                const plainText = `Test Report
==================
Generated: ${new Date().toLocaleString()}
Test Status: Working

This is a test of the text download functionality.`;
                
                const blob = new Blob([plainText], { type: 'text/plain;charset=utf-8' });
                const url = window.URL.createObjectURL(blob);
                const filename = `test-report-${Date.now()}.txt`;
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                window.URL.revokeObjectURL(url);
                showStatus('✅ Text download triggered successfully');
            } catch (e) {
                showStatus('❌ Text download failed: ' + e.message);
            }
        }
    </script>
</body>
</html>